[sqlfluff]
dialect = snowflake
templater = dbt
max_line_length = 120
exclude_rules = L009

# Enable dbt automatically if dbt_project.yml exists
[sqlfluff:templater:dbt]
project_dir = .
profiles_dir = ~/.dbt


# -------------------
# Capitalization
# -------------------

[sqlfluff:rules:capitalisation.keywords]
capitalisation_policy = upper

[sqlfluff:rules:capitalisation.functions]
capitalisation_policy = upper

[sqlfluff:rules:capitalisation.types]
capitalisation_policy = upper

[sqlfluff:rules:capitalisation.identifiers]
enabled = false


# -------------------
# Layout & Spacing
# -------------------

[sqlfluff:rules:layout.indent]
indent_unit = space
tab_space_size = 4

[sqlfluff:rules:layout.commas]
line_position = trailing

[sqlfluff:rules:layout.operators]
operator_newline = after

[sqlfluff:rules:layout.cte_newline]
cte_newline = true

[sqlfluff:rules:layout.select_targets]
select_clause_trailing_comma = forbid


# -------------------
# dbt-friendly rules
# -------------------

[sqlfluff:rules:references.consistent]
allow_scalar = true

[sqlfluff:rules:structure.subquery]
forbid_subquery_in = from

[sqlfluff:rules:structure.join_condition_order]
preferred_first_table_in_join = earlier


# -------------------
# Jinja / dbt safety
# -------------------

[sqlfluff:rules:jinja.padding]
pad_inline = true

# -------------------
# Silence warnings
# -------------------

[sqlfluff:rules:aliasing.forbid]  # AL07
enabled = false


[sqlfluff:rules:structure.column_order]  # ST06
enabled = false

[sqlfluff:templater:jinja]
apply_dbt_builtins = true
